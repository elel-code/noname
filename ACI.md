# ADME 互补指数 (ACI) 定义

**ADME 互补指数 (ACI)** 是一个旨在替代传统“协同指数”的复合指标。它不预测药效学层面的协同作用，而是基于易于获取的理化与 ADME 特征，从“**可用性**”和“**互补性**”两个维度评估一个中药成分组合的潜力。

该指数的优化目标是：**最大化 ACI**，同时**最小化肝毒性**，从而构成一个双目标优化问题。

---

## 指标构成

ACI 由两部分加权构成：

1.  **平均单体可用性 (Mean Desirability, D)**:
    -   **目的**: 衡量组合中各成分自身的“成药潜力”。
    -   **计算**:
        1.  对每个成分，将其多个 ADME 特征（如分子量 MW, 亲脂性 AlogP, 口服生物利用度 OB 等）分别映射到一个 `[0, 1]` 区间的“理想”分数。
        2.  将这些分数进行**几何平均**，得到该成分的最终“可用性”得分 `D_i`。采用几何平均是为了确保任何一项特征的极端短板都会显著拉低总分。
        3.  最后，对组合中所有成分的 `D_i` 进行加权（按配比）平均，得到 `D`。

2.  **组合互补性 (Complementarity, C)**:
    -   **目的**: 衡量组合在 ADME 特征空间中的多样性或“互补”程度。一个高互补性的组合意味着其成员在特征上各有所长，而非挤在同一个狭窄的区域。
    -   **计算**:
        1.  对组合内所有成分的各项 ADME 特征，计算其归一化后的**方差**。
        2.  将得到的方差进行归一化处理（例如，除以一个预设的`complement_variance_max`），使其映射到 `[0, 1]` 区间，得到最终的互补性得分 `C`。

---

## 计算公式

ACI 的计算公式如下：

<p align="center">
  <strong>ACI = (1 - &lambda;) &sdot; D + &lambda; &sdot; C</strong>
</p>

-   **D**: 组合的平均单体可用性 (Mean Desirability)。
-   **C**: 组合的互补性 (Complementarity)。
-   **&lambda; (lambda_weight)**: 一个介于 `[0, 1]` 之间的权重因子，用于平衡可用性与互补性的重要性。
    -   `λ` 较高时，更偏好成员间特征差异大的组合。
    -   `λ` 较低时，更偏好每个成员自身都表现优异的组合。
    -   默认值通常设为 `0.3`，即以单体可用性为主，互补性为辅。
